'use strict';(function(r){function n(a){function f(e,a){if(!h(a))throw new TypeError(".on() needs a function");a.type=e;b.add(a);a.handle={on:function(){b.add(a);return a.handle},once:function(){return g(e,a)},off:function(){d(a);return a.handle}};return a.handle}function g(e,c){function b(){c.apply(a,arguments);d(b)}d(c);return f(e,b)}function d(a){b.has(a)&&b.delete(a)}a||(a={});var b=new Set,c=!1;a.on=f;a.once=g;a.off=f;a.emit=function(a){var d=arguments,f=this;!c&&0<b.size&&function(){var g=[].slice.call(d,
1),h=f;b.forEach(function(d){d.type!=a||c||d.apply(h,g)})}()};a.defineHandle=function(a,d){d||(d=a);this[a]=function(a,c){return(1==c?g:f)(d,a)}};a.stopall=function(a){c="boolean"===typeof a?a:!0};return a}function k(a){a||(a={});a=n(a);var f={Get:new Set,Set:new Set};l(a,"isObservable",m(!0));["$get","$set"].forEach(function(d){var b="$get"==d?"Get":"Set";l(a,d,m(function(a,d){h(a)&&(d=a,a="*");if(!h(d))throw Error("."+a+" no function");var g={prop:"string"===typeof a?a:"*",fn:d},p={on:function(){f[b].add(g);
return p},off:function(){f[b].delete(g);return p}};return p.on()}))});l(a,"$change",m(function(a,b){h(a)&&(b=a,a="*");if(!h(b))throw Error(".$change : no function");var c={prop:"string"===typeof a?a:"*",fn:b,multi:!0},e={on:function(){f.Get.add(c);f.Set.add(c);return e},off:function(){f.Get.delete(c);f.Set.delete(c);return e}};return e.on}));l(a,"get",m(function(d){if("get"!=d&&"set"!=d){var b=void 0;f.Get.forEach(function(c){if("*"===c.prop||c.prop===d)b=c.multi?c.fn("get",d,a):c.fn(d,a)});return void 0!=
b?b:a[d]}return a[d]}));l(a,"set",m(function(d,b){var c=void 0;f.Set.forEach(function(e){if("*"===e.prop||e.prop===d)c=e.multi?e.fn("set",d,b,a,Object.hasOwnProperty(a,d)):e.fn(d,b,a,Object.hasOwnProperty(a,d))});c=void 0!=c?c:b;q(c)&&!c.isObservable&&(c=k(c));a.emit("$uberset:"+d,c);a[d]=c}));for(var g in a)q(a[g])&&!a[g].isObservable&&(a[g]=k(a[g]));if("undefined"!=typeof Proxy)return new Proxy(a,{get:function(a,b){if("get"!=b&&"set"!=b){var c=void 0;f.Get.forEach(function(e){if("*"===e.prop||e.prop===
b)c=e.multi?e.fn("get",b,a):e.fn(b,a)});return void 0!=c?c:Reflect.get(a,b)}return Reflect.get(a,b)},set:function(a,b,c){var e=void 0,g=!1;f.Set.forEach(function(f){if("*"===f.prop||f.prop===b)g?(c=e,g=!1):g=!0,e=f.multi?f.fn("set",b,c,a,!Reflect.has(a,b)):f.fn(b,c,a,!Reflect.has(a,b))});e=void 0!=e?e:c;q(e)&&!e.isObservable&&(e=k(e));a.emit("$uberset:"+b,e);return Reflect.set(a,b,e)}});console.warn("This Browser does not support Proxy, observables need to use the .set and .get accessors to work");
return a}var h=function(a){return"function"===typeof a},q=function(a){return"[object Object]"===toString.call(a)},l=Object.defineProperty,m=function(a,f,g){return{value:a,write:"boolean"===typeof f?f:!1,enumerable:"boolean"===typeof g?g:!1}};"undefined"!==typeof exports?module.exports={observable:k,eventsys:n}:(r.observable=k,r.eventsys=n)})(this);
