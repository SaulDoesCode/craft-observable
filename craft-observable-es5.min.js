'use strict';(function(n){function g(){var a=new Map,e={delete:function(c,b){if(e.has(c,b)){var d=a.get(c);d.size||a.delete(c);d.has(b)&&d.delete(b)}},set:function(c,b,d){k(b)&&(a.has(c)||a.set(c,new Set),!0===d&&(b.__isOnce=!0),a.get(c).add(b))},get:function(c){return a.get(c)},has:function(c,b){return 0<a.size&&a.has(c)&&a.get(c).has(b)},loop:function(c,b){0<a.size&&a.has(c)&&function(){var d=a.get(c);d.forEach(function(a){b(a);!0===a.__isOnce&&d.delete(a)})}()},makeHandle:function(a,b){if(!k(b))throw new TypeError("eventsys : listener needs a function");
return{on:function(){Array.isArray(a)?a.map(function(a){e.set(a,b)}):e.set(a,b);return this},once:function(){Array.isArray(a)?a.map(function(a){e.set(a,b,!0)}):e.set(a,b,!0);return this},off:function(){Array.isArray(a)?a.map(function(a){e.delete(a,b)}):e.delete(a,b);return this}}}};return e}function p(a){a||(a={});var e=g(),c=!1;return r(a,{on:function(a,d){return e.makeHandle(a,d).on()},once:function(a,d){return e.makeHandle(a,d).once()},off:function(a,d){return e.makeHandle(a,d).off()},emit:function(b){var d=
arguments;if(c||"string"!==typeof b)throw new TypeError("eventsys : you cannot emit that! "+b);(function(){var c=[].slice.call(d,1);e.loop(b,function(d){d.apply(a,c)})})()},stopall:function(a){return c="boolean"===typeof a?a:!0},defineHandle:function(b,d){d||(d=b);a[b]=function(b,f){return a[f?"once":"on"](d,b)}}})}function h(a,e){a||(a={});e||(a=p(a));var c=g();l(a,"isObservable",m(!0));["$get","$set"].map(function(d){var b="$get"==d?"Get":"Set";l(a,d,m(function(a,d){k(a)&&(d=a,a="*");if(!k(d))throw Error("."+
a+" no function");d.prop="string"===typeof a?a:"*";return c.makeHandle(b,d).on()}))});l(a,"get",m(function(d){if("get"!=d&&"set"!=d){var b=void 0;c.loop("Get",function(c){if("*"===c.prop||c.prop===d)b=c(d,a)});return void 0!=b?b:a[d]}return a[d]}));l(a,"set",m(function(d,b){var f=void 0;c.loop("Set",function(c){if("*"===c.prop||c.prop===d)f=c(d,b,a,Object.hasOwnProperty(a,d))});f=void 0!=f?f:b;q(f)&&!f.isObservable&&(f=h(f));a.emit("$uberset:"+d,f);a[d]=f}));for(var b in a)q(a[b])&&!a[b].isObservable&&
(a[b]=h(a[b]));if("undefined"!=typeof Proxy)return new Proxy(a,{get:function(a,b){if("get"!=b&&"set"!=b){var f=void 0;c.loop("Get",function(c){if("*"===c.prop||c.prop===b)f=c(b,a)});return void 0!=f?f:Reflect.get(a,b)}return Reflect.get(a,b)},set:function(a,b,f){var e=void 0,g=!1;c.loop("Set",function(c){if("*"===c.prop||c.prop===b)g?(f=e,g=!1):g=!0,e=c(b,f,a,!Reflect.has(a,b))});e=void 0!=e?e:f;q(e)&&!e.isObservable&&(e=h(e));a.emit("$uberset:"+b,e);return Reflect.set(a,b,e)}});console.warn("This JavaScript Environment does not support Proxy, observables need to use the .set and .get accessors to work");
return a}var k=function(a){return"function"===typeof a},q=function(a){return"[object Object]"===toString.call(a)},r=Object.assign,l=Object.defineProperty,m=function(a,e,c){return{value:a,write:"boolean"===typeof e?e:!1,enumerable:"boolean"===typeof c?c:!1}};"undefined"!==typeof exports?module.exports={observable:h,eventsys:p,listener:g}:(n.observable=h,n.eventsys=p,n.listener=g)})(this);
